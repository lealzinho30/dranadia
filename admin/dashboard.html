<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Painel Administrativo</title>
    <link rel="stylesheet" href="admin.css">
    <style>
        :root {
            --primary-color: #2da7ba;
            --primary-dark: #238a9a;
            --secondary-color: #f19022;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo-admin">
                    <i class="fas fa-tooth"></i>
                    <span>Admin</span>
                </div>
            </div>
            
            <nav class="sidebar-menu">
                <a href="dashboard.html" class="menu-item active">
                    <i class="fas fa-home"></i>
                    Dashboard
                </a>
                <a href="mensagens.html" class="menu-item">
                    <i class="fas fa-envelope"></i>
                    Mensagens
                    <span id="unreadBadge" class="badge badge-danger" style="float: right; margin-top: 2px;"></span>
                </a>
                <a href="conteudo.html" class="menu-item">
                    <i class="fas fa-edit"></i>
                    Conteúdo
                </a>
                <a href="config.html" class="menu-item">
                    <i class="fas fa-cog"></i>
                    Configurações
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-details">
                        <div class="user-name" id="userName">Administrador</div>
                        <div class="user-status" id="userInfo">Online</div>
                    </div>
                </div>
                <button class="btn-logout" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    Sair
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <header class="admin-header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="header-title">Dashboard</h1>
                </div>
                <div class="header-right">
                    <a href="../index.html" target="_blank" class="btn btn-secondary btn-sm">
                        <i class="fas fa-external-link-alt"></i>
                        Ver Site
                    </a>
                </div>
            </header>

            <div class="admin-content">
                <div class="page-header">
                    <h2 class="page-title">Visão Geral</h2>
                    <p class="page-subtitle">Estatísticas e informações do site</p>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid" id="statsGrid">
                    <!-- Será preenchido via JavaScript -->
                </div>

                <!-- Recent Messages -->
                <div class="content-card">
                    <div class="card-header">
                        <h3 class="card-title">Mensagens Recentes</h3>
                        <a href="mensagens.html" class="btn btn-secondary btn-sm">
                            Ver Todas
                            <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>E-mail</th>
                                    <th>Telefone</th>
                                    <th>Data</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="recentMessages">
                                <!-- Será preenchido via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="auth.js"></script>
    <script src="admin.js"></script>
    <script>
        // Verificar autenticação
        if (!auth.isAuthenticated()) {
            window.location.href = 'index.html';
        }

        // Carregar estatísticas
        function loadDashboard() {
            const stats = adminFunctions.getStats();
            const messages = adminFunctions.loadMessages().slice(0, 5);

            // Atualizar badges
            const unreadBadge = document.getElementById('unreadBadge');
            if (stats.unread > 0) {
                unreadBadge.textContent = stats.unread;
                unreadBadge.style.display = 'inline-block';
            } else {
                unreadBadge.style.display = 'none';
            }

            // Renderizar estatísticas
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-title">Total de Mensagens</span>
                        <div class="stat-icon primary">
                            <i class="fas fa-envelope"></i>
                        </div>
                    </div>
                    <div class="stat-value">${stats.total}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-title">Não Lidas</span>
                        <div class="stat-icon warning">
                            <i class="fas fa-envelope-open"></i>
                        </div>
                    </div>
                    <div class="stat-value">${stats.unread}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-title">Hoje</span>
                        <div class="stat-icon success">
                            <i class="fas fa-calendar-day"></i>
                        </div>
                    </div>
                    <div class="stat-value">${stats.today}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-title">Este Mês</span>
                        <div class="stat-icon info">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                    </div>
                    <div class="stat-value">${stats.thisMonth}</div>
                </div>
            `;

            // Renderizar mensagens recentes
            const recentMessages = document.getElementById('recentMessages');
            if (messages.length === 0) {
                recentMessages.innerHTML = `
                    <tr>
                        <td colspan="5" class="text-center" style="padding: 3rem;">
                            <div class="empty-state">
                                <i class="fas fa-inbox"></i>
                                <p>Nenhuma mensagem ainda</p>
                            </div>
                        </td>
                    </tr>
                `;
            } else {
                recentMessages.innerHTML = messages.map(msg => `
                    <tr>
                        <td><strong>${msg.nome}</strong></td>
                        <td>${msg.email}</td>
                        <td>${msg.telefone}</td>
                        <td>${adminFunctions.formatDate(msg.date)}</td>
                        <td>
                            <span class="badge ${msg.read ? 'badge-success' : 'badge-warning'}">
                                ${msg.read ? 'Lida' : 'Não lida'}
                            </span>
                        </td>
                    </tr>
                `).join('');
            }
        }

        // Inicializar dashboard
        loadDashboard();
    </script>
</body>
</html>

